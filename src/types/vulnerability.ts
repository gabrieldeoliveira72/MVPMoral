// Tipos para vulnerabilidades e dados do CVSS

export interface CVSSData {
  version: string;
  vectorString: string;
  baseScore: number;
  baseSeverity: "CRITICAL" | "HIGH" | "MEDIUM" | "LOW" | "NONE";
  exploitabilityScore?: number;
  impactScore?: number;
  attackVector?: string;
  attackComplexity?: string;
  privilegesRequired?: string;
  userInteraction?: string;
  scope?: string;
  confidentialityImpact?: string;
  integrityImpact?: string;
  availabilityImpact?: string;
}

export interface OWASPVulnerability {
  id: string;
  name: string;
  description: string;
  severity: "CRITICAL" | "HIGH" | "MEDIUM" | "LOW" | "INFO";
  cwe?: string;
  cve?: string;
  file?: string;
  line?: number;
  rule?: string;
  message?: string;
  confidence?: number;
}

export interface MLPrediction {
  isRealThreat: boolean;
  confidence: number;
  bertScore: number;
  naiveBayesScore: number;
  reasoning: string;
}

export interface TriagedVulnerability {
  id: string;
  original: OWASPVulnerability;
  cvssData?: CVSSData;
  mlPrediction: MLPrediction;
  finalSeverity: "CRITICAL" | "HIGH" | "MEDIUM" | "LOW" | "INFO" | "FALSE_POSITIVE";
  priority: number; // 0-100, maior = mais priorit√°rio
  shouldInvestigate: boolean;
  triageReason: string;
}

export interface TriageResult {
  total: number;
  realThreats: number;
  falsePositives: number;
  critical: number;
  high: number;
  medium: number;
  low: number;
  vulnerabilities: TriagedVulnerability[];
}

